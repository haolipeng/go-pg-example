[{"table":"account","item":"password","err":null,"expected":"检查 /etc/pam.d/common-password 或 /etc/pam.d/password-auth 中是否存在 null字符串(存在为:失败)","desc":"禁止帐号的密码配置为空密码","resClass":"文件","resParam":"/etc/pam.d/common-password;/etc/pam.d/password-auth","funcName":"account.DetectNullPasswd"},{"table":"account","item":"password","err":null,"expected":"PASS_MIN_LEN\u003e=15","desc":"登录系统的密码必须包含一个至少15个字符","resClass":"文件","resParam":"/etc/login.defs","funcName":"account.DetectPasswdMinLen"},{"table":"account","item":"password","err":null,"expected":"检查 /etc/shadow 中每行第1列(以:分割)不为root且第2列不为和*的字符串行是否为0(不为0则失败)","desc":"除了root以外的默认的帐号,必须进行锁定","resClass":"文件","resParam":"/etc/shadow","funcName":"account.DetectLockOfNonRoot"},{"table":"account","item":"user","err":null,"expected":"检查 /etc/default/useradd 文件(等号做分割)中 INACTIVE 字段数值是否大于35(小于等于则错误)","desc":"帐户必须在35天不使用后被锁定","resClass":"文件","resParam":"/etc/default/useradd","funcName":"account.DetectInactive"},{"table":"account","item":"failRetry","err":null,"expected":"配置onerr=fail deny=3 unlock_time=300,设置连续输错三次密码,账号锁定五分钟","desc":"检测账户登录次数限制,连续输入错N次,将会锁定账户","resClass":"文件","resParam":"/etc/pam.d/system-auth;/etc/pam.d/common-auth","funcName":"account.DetectFailRetry"},{"table":"account","item":"password","err":null,"expected":"检查 /etc/pam.d/system-auth 或 /etc/pam.d/system-auth-ac 文件中是否存在 nullok 字符串(存在则失败)","desc":"系统不能有配置空白或空密码的帐户","resClass":"文件","resParam":"/etc/pam.d/system-auth;/etc/pam.d/system-auth-ac","funcName":"account.DetectSystemAuth"},{"table":"account","item":"user","err":null,"expected":"用户不等于adm,lp,sync,shutdown,halt,news,uucp,operator,games,gopher等","desc":"检测安装os或package时,默认生成的账号(大部分使用默认的密码)","resClass":"文件","resParam":"/etc/passwd","funcName":"account.DetectUnnecessaryAccount"},{"table":"account","item":"password","err":null,"expected":"PASS_MAX_DAYS\u003c=60","desc":"用户密码必须至少每60天进行修改","resClass":"文件","resParam":"/etc/login.defs","funcName":"account.DetectPasswdMaxDays"},{"table":"account","item":"password","err":null,"expected":"检查 /etc/syslog.conf 文件中是否存在 authpriv.* 字符串(存在则失败)","desc":"root用户密码永远不使用明文发送到网络连接","resClass":"文件","resParam":"/etc/syslog.conf","funcName":"account.DetectAuthPriv"},{"table":"account","item":"permission","err":null,"expected":"检查 /etc/passwd 文件中的 ftp: 行,检查第7列(冒号分割)是否等于/bin/false /dev/null /usr/bin/false /bin/true /sbin/nologin 其中之一","desc":"匿名FTP帐户不能使用shell功能","resClass":"文件","resParam":"/etc/passwd","funcName":"account.DetectFtp"},{"table":"account","item":"password","err":null,"expected":"PASS_MIN_DAYS\u003e=1","desc":"用户在24小时内不能够再次修改密码","resClass":"文件","resParam":"/etc/login.defs","funcName":"account.DetectPasswdMinDays"},{"table":"account","item":"password","err":null,"expected":"检查 /etc/libuser.conf 文件是否存在,查找是否有 crypt_style = `sha512` 配置项(不存在则错误)","desc":"系统必须使用FIPS 140-2认可的加密哈希算法生成帐号密码哈希值","resClass":"文件","resParam":"/etc/libuser.conf","funcName":"account.DetectCryptStyle"},{"table":"account","item":"sudo","err":null,"expected":"除了root和wheel组,无其他账号有ALL=(ALL)配置","desc":"Sudo账号切换到root账号时无密码","resClass":"文件","resParam":"/etc/sudoers","funcName":"account.DetectSudoWithoutPasswd"},{"table":"account","item":"umask","err":null,"expected":"检测umask值是否为027、0027、077、0077其一,如果是,代表风险检测通过","desc":"检测umask值","resClass":"文件","resParam":"/etc/bashrc;/etc/bash.bashrc;/etc/bash.bashrc.local;/etc/csh.cshrc;/etc/profile","funcName":"account.DetectUmask"},{"table":"account","item":"password","err":null,"expected":"检查 /etc/passwd 每行第2列(以:分割),是否都等于x(存在不为x则失败)","desc":"/etc/passwd文件必须不包含密码的哈希值","resClass":"文件","resParam":"/etc/passwd","funcName":"account.DetectNotContainPasswdHash"},{"table":"account","item":"permission","err":null,"expected":"操作系统所有文件权限为755","desc":"检测操作系统所有文件权限是否为755(有不是755则失败)","resClass":"文件","resParam":"/bin;/usr/bin;/usr/local/bin;/sbin;/usr/local/sbin;/usr/sbin","funcName":"account.DetectSystemFilePermission"},{"table":"account","item":"wheel","err":null,"expected":"存在字符串auth required pam_wheel.so use_uid","desc":"检测非wheel组用户是否可切换到root","resClass":"文件","resParam":"/etc/pam.d/su","funcName":"account.DetectNonWheelSuToRootEnable"},{"table":"account","item":"permission","err":null,"expected":"检查 /etc/shadow 的操作属性是否为000(不为000则失败)\n检查 /etc/gshadow 的操作属性是否为000(不为000则失败)\n检查 /etc/passwd 的操作属性是否为644(不为644则失败)\n检查 /etc/group 的操作属性是否为644(不为644则失败)","desc":"/etc/gshadow;/etc/shadow;/etc/passwd;/etc/group文件的所属组必须为root组,所属用户必须为root","resClass":"文件","resParam":"/etc/gshadow;/etc/shadow;/etc/passwd;/etc/group","funcName":"account.DetectAccountPermission"},{"table":"account","item":"permission","err":null,"expected":"/etc/passwd 中第1列为root的行(以:分割),第3列等于0(不为0则失败)","desc":"root帐号的UID必须且仅为0","resClass":"文件","resParam":"/etc/passwd","funcName":"account.DetectRootUID"},{"table":"account","item":"password","err":null,"expected":"PASS_WARN_AGE\u003e=7","desc":"必须在密码无效的7天前对用户进行警告","resClass":"文件","resParam":"/etc/login.defs","funcName":"account.DetectPasswdWarnAge"},{"table":"account","item":"sudo","err":null,"expected":"检查 /etc/sudoers 文件内容,不能存在 NOPASSWD 或 !authenticate 配置项","desc":"使用sudo命令必须进行验证","resClass":"文件","resParam":"/etc/sudoers","funcName":"account.DetectSudoAuth"}]
